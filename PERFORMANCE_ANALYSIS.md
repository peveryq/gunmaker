# Анализ производительности системы мишеней для WebGL

## Текущее состояние (20-30 мишеней)

### ✅ Что уже оптимизировано:
1. **BulletHoleManager** - использует пулинг (макс. 50 дырок)
2. **Нет Update/FixedUpdate** в ShootingTarget - нет постоянных проверок
3. **DOTween анимации** - эффективны, не создают GC
4. **Particle systems переиспользуются** - создаются один раз на мишень

### ⚠️ Проблемы производительности:

#### 1. **DamageNumber пулинг ВЫКЛЮЧЕН** (КРИТИЧНО!)
- **Проблема**: При каждом попадании создается новый GameObject через `Instantiate()`
- **Влияние**: При активной стрельбе по 20-30 мишеням = сотни `Instantiate()` в секунду
- **GC**: Высокая нагрузка на сборщик мусора в WebGL
- **Решение**: ✅ **ИСПРАВЛЕНО** - включен пулинг (poolSize: 30)

#### 2. **Particle Systems не пулятся**
- **Проблема**: Создаются через `Instantiate()` при первом попадании (40-60 экземпляров для 20-30 мишеней)
- **Влияние**: Среднее - объекты переиспользуются, но создаются при старте
- **Решение**: Можно оптимизировать через общий пул, но не критично

#### 3. **AudioSource на каждой мишени**
- **Проблема**: 20-30 AudioSource одновременно
- **Влияние**: Среднее - может быть проблемой на слабых устройствах
- **Решение**: Использовать AudioManager с пулом источников

#### 4. **Коллайдеры**
- **Рекомендация**: Использовать простые коллайдеры (Box/Sphere), избегать Mesh Collider
- **Проверка**: Убедиться, что коллайдеры не слишком сложные

## Оценка производительности для среднего устройства

### Сценарий: 20-30 мишеней, активная стрельба

**Оптимистично (после исправлений):**
- ✅ **60 FPS** на среднем устройстве
- ✅ Низкая нагрузка на GC
- ✅ Стабильная производительность

**Пессимистично (без оптимизаций):**
- ⚠️ **30-45 FPS** на среднем устройстве
- ⚠️ Периодические просадки из-за GC
- ⚠️ Возможны лаги при активной стрельбе

## Рекомендации по оптимизации

### Критичные (сделать обязательно):
1. ✅ **Включить пулинг DamageNumber** - ДЕЛАЕТСЯ
2. **Проверить типы коллайдеров** - использовать Box/Sphere вместо Mesh
3. **Ограничить количество активных частиц** - настроить maxParticles в ParticleSystem

### Желательные (для лучшей производительности):
1. **AudioManager с пулом** - вместо AudioSource на каждой мишени
2. **LOD для мишеней** - упрощенные модели на расстоянии
3. **Culling** - отключать мишени вне камеры
4. **Ограничить количество DamageNumber** - комбинировать близкие числа

### Дополнительные оптимизации:
1. **Object pooling для пуль** - если их много одновременно
2. **Batching** - объединить статичные части мишеней
3. **Occlusion Culling** - если мишени могут перекрываться

## Итоговая оценка

**После включения пулинга DamageNumber:**
- ✅ **Система готова для 20-30 мишеней на среднем устройстве**
- ✅ Производительность должна быть стабильной
- ⚠️ Рекомендуется протестировать на реальных WebGL устройствах

**Дополнительные оптимизации** улучшат производительность, но не критичны для базового функционала.

